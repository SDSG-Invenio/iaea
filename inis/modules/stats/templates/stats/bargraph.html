{%- extends "page.html" -%}

{%- block body -%}

<div class="well">
  <div class="row vertical-align">
    <div class="col-md-9">
        <h1><i class="fa fa-bar-chart-o fa-fw"></i>&nbsp;Statistics</h1>
    </div>
    <div class="col-md-3">
      <div class="btn-group" role="group" aria-label="..." style="margin-top: 20px;">
          {% for option in ('weeks', 'months', 'years') %}
            {% if time_range == option %}
              {% set active = 'btn-primary' %}
            {% else %}
              {% set active = 'btn-default' %}
            {% endif %}
            <a class="btn {{ active }}" 
               href="{{ url_for('stats.graphs', time_range=option) }}"
               role="button">{{ option|title }}</a>
          {% endfor %}
      </div>
    </div>
  </div>

<div class="table-responsive">
    <table class="table table-striped table-condensed table-hover">
        <tr>
            <th class='text-center col-md-1'><li class="list-group-item">Period</li></th>
            <th class='text-center'><li class="list-group-item">Submissions</li></th>
            <th class='text-center'><li class="list-group-item">Records</li></th>
            <th class='text-center'><li class="list-group-item">Files</li></th>
        </tr>
        {% for r in ranges %}
        <tr>
        {% if time_range == 'months' %}
            <td class='text-center'>{{ r[0]|truncate(8, killwords=True, end='') }}</td>
        {% else %}
            <td class='text-center'>{{ r[0] }}</td>
        {% endif %}
            <td class='col-md-3'>
                <div class="progress" style="margin-bottom: 0px;">
                    <div class="progress-bar progress-bar-active"
                         style="width: {{ (r[1]|list|count * 100)/max_submissions }}%;">
                        {{ r[1]|list|count }}
                    </div>
                </div>
            </td>
            <td class='col-md-3'>
                <div class="progress" style="margin-bottom: 0px;">
                    <div class="progress-bar progress-bar-info"
                         style="width: {{ (r[1]|sum(attribute='records')  * 100)/max_records }}%;">
                        {{ r[1]|sum(attribute='records') }}
                    </div>
                </div>
            </td>
            <td class='col-md-3'>
                <div class="progress" style="margin-bottom: 0px;">
                    <div class="progress-bar progress-bar-info"
                         style="width: {{ (r[1]|sum(attribute='files_no')  * 100)/max_files }}%;">
                        {{ r[1]|sum(attribute='files_no') }}
                    </div>
                </div>
            </td>
        </tr>
        {%- endfor %}
    </table>
</div>
{%- endblock body -%}
